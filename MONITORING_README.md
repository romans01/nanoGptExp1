# üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è nanoGPT

–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π nanoGPT.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
```bash
# –û–±—É—á–µ–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –≥—Ä–∞—Ñ–∏–∫–æ–≤
python train_with_logging.py config/train_shakespeare_char.py --max_iters=1000

# –û–±—É—á–µ–Ω–∏–µ BPE –º–æ–¥–µ–ª–∏ —Å –Ω—É–ª—è
python train_with_logging.py config/train_shakespeare_bpe.py --max_iters=2000
```

### –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ª–æ–≥–æ–≤
```bash
# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ª–æ–≥–∞
./analyze_training.sh

# –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
./analyze_training.sh path/to/training.log

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Python
python plot_training_advanced.py training.log
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:
```
training_plots/
‚îú‚îÄ‚îÄ training_metrics_YYYYMMDD_HHMMSS.png  # –ì—Ä–∞—Ñ–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ training_summary_YYYYMMDD_HHMMSS.txt  # –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç
‚îú‚îÄ‚îÄ training_data_YYYYMMDD_HHMMSS.json    # –î–∞–Ω–Ω—ã–µ –≤ JSON
‚îî‚îÄ‚îÄ iter_N_YYYYMMDD_HHMMSS.png           # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
```

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
- `train_with_logging.py` - –û–±—É—á–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- `plot_training_advanced.py` - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
- `analyze_training.sh` - –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ (bash —Å–∫—Ä–∏–ø—Ç)

## üìä –ß—Ç–æ –≤–∫–ª—é—á–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫–∏

### 1. Train vs Validation Loss
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ training –∏ validation loss
- –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞ –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

### 2. Training Loss (–¥–µ—Ç–∞–ª—å–Ω—ã–π)
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ training loss –ø–æ –∏—Ç–µ—Ä–∞—Ü–∏—è–º
- –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
- –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞

### 3. Training Time per Iteration
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤
- –ü–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 4. Model FLOPs Utilization (MFU)
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

## üìÑ –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Å–ª–æ–∏, –≥–æ–ª–æ–≤—ã, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å)
- –†–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è:
- –ù–∞—á–∞–ª—å–Ω—ã–π –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π loss
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–ª—É—á—à–µ–Ω–∏—è
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é
- –°—Ä–µ–¥–Ω—è—è —É—Ç–∏–ª–∏–∑–∞—Ü–∏—è GPU

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
- –î–∏–Ω–∞–º–∏–∫–∞ train/val loss
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ val/train loss

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏** –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤
- **–û—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞** –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏** –ø–æ–¥ –∫–∞–∂–¥—ã–º –≥—Ä–∞—Ñ–∏–∫–æ–º
- **–°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ** –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è
- **–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–µ —à–∫–∞–ª—ã** –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
- **JSON –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- –ì—Ä–∞—Ñ–∏–∫–∏ –∫–∞–∂–¥—ã–µ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π
- –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

### ‚úÖ –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
- Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ª–æ–≥–æ–≤
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:
–í —Ñ–∞–π–ª–µ `train_with_logging.py` –∏–∑–º–µ–Ω–∏—Ç–µ:
```python
if latest_iter % 100 == 0:  # –ö–∞–∂–¥—ã–µ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è:
–í —Ñ–∞–π–ª–µ `plot_training_advanced.py`:
```python
window = min(50, len(data) // 10)  # –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞
```

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π:
```bash
# –û–±—É—á–∞–µ–º character-level –º–æ–¥–µ–ª—å
python train_with_logging.py config/train_shakespeare_char.py --max_iters=1000

# –û–±—É—á–∞–µ–º BPE –º–æ–¥–µ–ª—å
python train_with_logging.py config/train_shakespeare_bpe.py --max_iters=1000

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–∞–ø–∫–µ training_plots/
```

### –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:
–°–º–æ—Ç—Ä–∏—Ç–µ –≤ –æ—Ç—á–µ—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ val/train loss: 128.35 (–≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ)
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏ MFU –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è:
- –ü–æ–¥–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ batch_size
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ GPU
- –í—ã—è–≤–ª–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç

## üé≠ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

### Character-level (shakespeare_char):
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: ~21M
- **–°–ª–æ–≤–∞—Ä—å**: 65 —Å–∏–º–≤–æ–ª–æ–≤
- **–í—Ä–µ–º—è**: ~15-20ms/iter
- **MFU**: ~23%

### BPE from scratch (shakespeare_bpe):
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: ~123M  
- **–°–ª–æ–≤–∞—Ä—å**: 50,304 —Ç–æ–∫–µ–Ω–æ–≤
- **–í—Ä–µ–º—è**: ~135ms/iter
- **MFU**: ~25%

### Fine-tuning GPT-2:
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: 1.56B
- **–°–ª–æ–≤–∞—Ä—å**: 50,257 —Ç–æ–∫–µ–Ω–æ–≤
- **–ë—ã—Å—Ç—Ä–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è**: –ù–µ—Å–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –º–æ–¥–µ–ª–∏ –∏ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.
